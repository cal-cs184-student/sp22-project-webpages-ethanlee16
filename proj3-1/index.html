<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type" />
    <style type="text/css">
      @import url("https://themes.googleusercontent.com/fonts/css?kit=rfSAlb2JfKqknMZbyNv1qV29xYLMNP9vet3hC-7hSAN6Bl3ec3IfxFtMQgNGyplj");
      body.c54 {
        margin-left: auto;
        margin-right: auto;
      }
      .lst-kix_mddnp4wtftwe-3 > li:before {
        content: "\0025cf  ";
      }
      .lst-kix_mddnp4wtftwe-1 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_mddnp4wtftwe-4 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_mddnp4wtftwe-0 > li:before {
        content: "\0025cf  ";
      }
      ul.lst-kix_mddnp4wtftwe-1 {
        list-style-type: none;
      }
      .lst-kix_mddnp4wtftwe-6 > li:before {
        content: "\0025cf  ";
      }
      ul.lst-kix_mddnp4wtftwe-2 {
        list-style-type: none;
      }
      .lst-kix_mddnp4wtftwe-5 > li:before {
        content: "\0025a0  ";
      }
      .lst-kix_mddnp4wtftwe-7 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_93ip9l4swuse-8 > li:before {
        content: "\0025a0  ";
      }
      ul.lst-kix_mddnp4wtftwe-0 {
        list-style-type: none;
      }
      .lst-kix_93ip9l4swuse-4 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_93ip9l4swuse-6 > li:before {
        content: "\0025cf  ";
      }
      .lst-kix_93ip9l4swuse-7 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_93ip9l4swuse-3 > li:before {
        content: "\0025cf  ";
      }
      .lst-kix_mddnp4wtftwe-2 > li:before {
        content: "\0025a0  ";
      }
      .lst-kix_93ip9l4swuse-5 > li:before {
        content: "\0025a0  ";
      }
      ul.lst-kix_kv4r27phas62-0 {
        list-style-type: none;
      }
      ul.lst-kix_kv4r27phas62-2 {
        list-style-type: none;
      }
      ul.lst-kix_kv4r27phas62-1 {
        list-style-type: none;
      }
      ul.lst-kix_kv4r27phas62-4 {
        list-style-type: none;
      }
      ul.lst-kix_kv4r27phas62-3 {
        list-style-type: none;
      }
      ul.lst-kix_kv4r27phas62-6 {
        list-style-type: none;
      }
      ul.lst-kix_kv4r27phas62-5 {
        list-style-type: none;
      }
      ul.lst-kix_kv4r27phas62-8 {
        list-style-type: none;
      }
      ul.lst-kix_kv4r27phas62-7 {
        list-style-type: none;
      }
      .lst-kix_93ip9l4swuse-0 > li:before {
        content: "\0025cf  ";
      }
      .lst-kix_93ip9l4swuse-2 > li:before {
        content: "\0025a0  ";
      }
      .lst-kix_93ip9l4swuse-1 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_kv4r27phas62-1 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_mddnp4wtftwe-8 > li:before {
        content: "\0025a0  ";
      }
      .lst-kix_kv4r27phas62-0 > li:before {
        content: "\0025cf  ";
      }
      .lst-kix_kv4r27phas62-4 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_kv4r27phas62-3 > li:before {
        content: "\0025cf  ";
      }
      .lst-kix_kv4r27phas62-2 > li:before {
        content: "\0025a0  ";
      }
      .lst-kix_kv4r27phas62-7 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_kv4r27phas62-8 > li:before {
        content: "\0025a0  ";
      }
      .lst-kix_kv4r27phas62-5 > li:before {
        content: "\0025a0  ";
      }
      .lst-kix_kv4r27phas62-6 > li:before {
        content: "\0025cf  ";
      }
      ul.lst-kix_93ip9l4swuse-1 {
        list-style-type: none;
      }
      ul.lst-kix_93ip9l4swuse-0 {
        list-style-type: none;
      }
      ul.lst-kix_93ip9l4swuse-3 {
        list-style-type: none;
      }
      .lst-kix_e3u0txfbhggd-8 > li:before {
        content: "\0025a0  ";
      }
      ul.lst-kix_93ip9l4swuse-2 {
        list-style-type: none;
      }
      ul.lst-kix_93ip9l4swuse-5 {
        list-style-type: none;
      }
      ul.lst-kix_93ip9l4swuse-4 {
        list-style-type: none;
      }
      ul.lst-kix_93ip9l4swuse-7 {
        list-style-type: none;
      }
      .lst-kix_e3u0txfbhggd-6 > li:before {
        content: "\0025cf  ";
      }
      .lst-kix_e3u0txfbhggd-7 > li:before {
        content: "\0025cb  ";
      }
      ul.lst-kix_93ip9l4swuse-6 {
        list-style-type: none;
      }
      ul.lst-kix_93ip9l4swuse-8 {
        list-style-type: none;
      }
      li.li-bullet-0:before {
        margin-left: -18pt;
        white-space: nowrap;
        display: inline-block;
        min-width: 18pt;
      }
      ul.lst-kix_e3u0txfbhggd-2 {
        list-style-type: none;
      }
      .lst-kix_e3u0txfbhggd-2 > li:before {
        content: "\0025a0  ";
      }
      .lst-kix_e3u0txfbhggd-3 > li:before {
        content: "\0025cf  ";
      }
      ul.lst-kix_e3u0txfbhggd-3 {
        list-style-type: none;
      }
      ul.lst-kix_mddnp4wtftwe-7 {
        list-style-type: none;
      }
      ul.lst-kix_e3u0txfbhggd-0 {
        list-style-type: none;
      }
      ul.lst-kix_mddnp4wtftwe-8 {
        list-style-type: none;
      }
      ul.lst-kix_e3u0txfbhggd-1 {
        list-style-type: none;
      }
      ul.lst-kix_mddnp4wtftwe-5 {
        list-style-type: none;
      }
      ul.lst-kix_mddnp4wtftwe-6 {
        list-style-type: none;
      }
      .lst-kix_e3u0txfbhggd-0 > li:before {
        content: "\0025cf  ";
      }
      .lst-kix_e3u0txfbhggd-1 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_e3u0txfbhggd-4 > li:before {
        content: "\0025cb  ";
      }
      .lst-kix_e3u0txfbhggd-5 > li:before {
        content: "\0025a0  ";
      }
      ul.lst-kix_mddnp4wtftwe-3 {
        list-style-type: none;
      }
      ul.lst-kix_mddnp4wtftwe-4 {
        list-style-type: none;
      }
      ul.lst-kix_e3u0txfbhggd-8 {
        list-style-type: none;
      }
      ul.lst-kix_e3u0txfbhggd-6 {
        list-style-type: none;
      }
      ul.lst-kix_e3u0txfbhggd-7 {
        list-style-type: none;
      }
      ul.lst-kix_e3u0txfbhggd-4 {
        list-style-type: none;
      }
      ul.lst-kix_e3u0txfbhggd-5 {
        list-style-type: none;
      }
      ol {
        margin: 0;
        padding: 0;
      }
      table td,
      table th {
        padding: 0;
      }
      .c39 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 218.2pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c37 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #000000;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #000000;
        vertical-align: top;
        border-right-color: #000000;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 177.8pt;
        border-top-color: #000000;
        border-bottom-style: solid;
      }
      .c22 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 291.8pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c32 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 234pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c30 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 110.2pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c4 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 321.8pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c11 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 156pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c21 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #000000;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #000000;
        vertical-align: top;
        border-right-color: #000000;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 126pt;
        border-top-color: #000000;
        border-bottom-style: solid;
      }
      .c29 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #000000;
        border-top-width: 0pt;
        border-right-width: 0pt;
        border-left-color: #000000;
        vertical-align: top;
        border-right-color: #000000;
        border-left-width: 0pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 0pt;
        width: 234pt;
        border-top-color: #000000;
        border-bottom-style: solid;
      }
      .c33 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 137.2pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c23 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 117pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c12 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #000000;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #000000;
        vertical-align: top;
        border-right-color: #000000;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 81pt;
        border-top-color: #000000;
        border-bottom-style: solid;
      }
      .c15 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #ffffff;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #ffffff;
        vertical-align: top;
        border-right-color: #ffffff;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 243.8pt;
        border-top-color: #ffffff;
        border-bottom-style: solid;
      }
      .c53 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #000000;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #000000;
        vertical-align: top;
        border-right-color: #000000;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 117pt;
        border-top-color: #000000;
        border-bottom-style: solid;
      }
      .c7 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #000000;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #000000;
        vertical-align: top;
        border-right-color: #000000;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 183.8pt;
        border-top-color: #000000;
        border-bottom-style: solid;
      }
      .c27 {
        border-right-style: solid;
        padding: 5pt 5pt 5pt 5pt;
        border-bottom-color: #000000;
        border-top-width: 1pt;
        border-right-width: 1pt;
        border-left-color: #000000;
        vertical-align: top;
        border-right-color: #000000;
        border-left-width: 1pt;
        border-top-style: solid;
        border-left-style: solid;
        border-bottom-width: 1pt;
        width: 92.2pt;
        border-top-color: #000000;
        border-bottom-style: solid;
      }
      .c5 {
        margin-left: 36pt;
        padding-top: 0pt;
        padding-bottom: 12pt;
        line-height: 1.15;
        orphans: 2;
        widows: 2;
        text-align: left;
        height: 11pt;
      }
      .c31 {
        color: #000000;
        font-weight: 400;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 16pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c26 {
        color: #434343;
        font-weight: 400;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 14pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c0 {
        color: #333333;
        font-weight: 400;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 11pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c9 {
        color: #000000;
        font-weight: 400;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 11pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c16 {
        padding-top: 18pt;
        padding-bottom: 6pt;
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      .c40 {
        padding-top: 16pt;
        padding-bottom: 12pt;
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      .c24 {
        color: #000000;
        font-weight: 400;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 9pt;
        font-family: "Inter";
        font-style: italic;
      }
      .c17 {
        padding-top: 0pt;
        padding-bottom: 12pt;
        line-height: 1.15;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      .c13 {
        font-weight: 700;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 12pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c36 {
        font-weight: 400;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 16pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c18 {
        padding-top: 0pt;
        padding-bottom: 0pt;
        line-height: 1.15;
        orphans: 2;
        widows: 2;
        text-align: center;
      }
      .c6 {
        font-weight: 400;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 12pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c28 {
        padding-top: 0pt;
        padding-bottom: 0pt;
        line-height: 1.15;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      .c42 {
        font-weight: 700;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 10pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c38 {
        font-weight: 700;
        text-decoration: none;
        vertical-align: baseline;
        font-size: 11pt;
        font-family: "Inter";
        font-style: normal;
      }
      .c19 {
        padding-top: 0pt;
        padding-bottom: 0pt;
        line-height: 1;
        text-align: right;
      }
      .c1 {
        padding-top: 0pt;
        padding-bottom: 0pt;
        line-height: 1;
        text-align: left;
      }
      .c43 {
        margin-left: 36pt;
        border-spacing: 0;
        border-collapse: collapse;
        margin-right: auto;
      }
      .c35 {
        margin-left: 39pt;
        border-spacing: 0;
        border-collapse: collapse;
        margin-right: auto;
      }
      .c52 {
        margin-left: -10.5pt;
        border-spacing: 0;
        border-collapse: collapse;
        margin-right: auto;
      }
      .c14 {
        margin-left: 6pt;
        border-spacing: 0;
        border-collapse: collapse;
        margin-right: auto;
      }
      .c25 {
        padding-top: 10pt;
        padding-bottom: 0pt;
        line-height: 1;
        text-align: right;
      }
      .c55 {
        margin-left: 17.2pt;
        border-spacing: 0;
        border-collapse: collapse;
        margin-right: auto;
      }
      .c41 {
        border-spacing: 0;
        border-collapse: collapse;
        margin-right: auto;
      }
      .c46 {
        margin-left: auto;
        border-spacing: 0;
        border-collapse: collapse;
        margin-right: auto;
      }
      .c54 {
        background-color: #ffffff;
        max-width: 468pt;
        padding: 72pt 72pt 72pt 72pt;
      }
      .c8 {
        font-family: "Times New Roman";
        font-style: italic;
        font-weight: 700;
      }
      .c34 {
        padding: 0;
        margin: 0;
      }
      .c48 {
        margin-left: 36pt;
        padding-left: 0pt;
      }
      .c50 {
        margin-left: 72pt;
        padding-left: 0pt;
      }
      .c49 {
        font-size: 10pt;
        font-weight: 700;
      }
      .c10 {
        font-weight: 400;
        font-family: "JetBrains Mono";
      }
      .c20 {
        height: 11pt;
      }
      .c47 {
        height: 16pt;
      }
      .c3 {
        height: 0pt;
      }
      .c44 {
        font-size: 9pt;
      }
      .c2 {
        color: #333333;
      }
      .c45 {
        height: 169.3pt;
      }
      .c51 {
        font-weight: 700;
      }
      .title {
        padding-top: 0pt;
        color: #000000;
        font-size: 26pt;
        padding-bottom: 3pt;
        font-family: "Inter";
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      .subtitle {
        padding-top: 0pt;
        color: #666666;
        font-size: 15pt;
        padding-bottom: 16pt;
        font-family: "Arial";
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      li {
        color: #000000;
        font-size: 11pt;
        font-family: "Inter";
      }
      p {
        margin: 0;
        color: #000000;
        font-size: 11pt;
        font-family: "Inter";
      }
      h1 {
        padding-top: 20pt;
        color: #000000;
        font-size: 20pt;
        padding-bottom: 6pt;
        font-family: "Inter";
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      h2 {
        padding-top: 18pt;
        color: #000000;
        font-size: 16pt;
        padding-bottom: 6pt;
        font-family: "Inter";
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      h3 {
        padding-top: 16pt;
        color: #434343;
        font-size: 14pt;
        padding-bottom: 4pt;
        font-family: "Inter";
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      h4 {
        padding-top: 14pt;
        color: #666666;
        font-size: 12pt;
        padding-bottom: 4pt;
        font-family: "Inter";
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      h5 {
        padding-top: 12pt;
        color: #666666;
        font-size: 11pt;
        padding-bottom: 4pt;
        font-family: "Inter";
        line-height: 1.15;
        page-break-after: avoid;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
      h6 {
        padding-top: 12pt;
        color: #666666;
        font-size: 11pt;
        padding-bottom: 4pt;
        font-family: "Inter";
        line-height: 1.15;
        page-break-after: avoid;
        font-style: italic;
        orphans: 2;
        widows: 2;
        text-align: left;
      }
    </style>
  </head>
  <body class="c54">
    <h2 class="c16" id="h.5oyg2ign2exf">
      <span class="c51">Project 3-1</span><span class="c31">: Pathtracing</span>
    </h2>
    <p class="c28"><span class="c9">By Annie Wang and Ethan Lee</span></p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28">
      <span class="c9"
        >In our project, we worked on implementing pathtracing techniques,
        including generating rays from the camera into the world space,
        identifying the objects and light sources they intersected (with
        optimized data structures to find intersections), and using those rays
        to determine the lighting in the scene resulting from both direct and
        indirect illumination.</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <h2 class="c16" id="h.5f1irucvp3d2">
      <span>Part 1: Ray Generation and Scene Intersection</span>
    </h2>
    <p class="c28">
      <span>Our ray generation algorithm begins with the renderer calling </span
      ><span class="c10">raytrace_pixel</span
      ><span class="c9"
        >&nbsp;for each pixel on the screen, which generates a fixed number of
        random rays going from the camera origin through the pixel&rsquo;s point
        in camera space. Each of these rays is generated by uniformly sampling a
        location from the unit square represented by this pixel and setting the
        direction of the ray to this location (with a transformation to world
        space applied).</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28">
      <span class="c9"
        >Once this ray is generated, we add to the light displayed in the pixel
        based on the normal vector of intersection between this ray and any
        primitive object. For this part, we built intersection tests for
        triangles (described below) and spheres, which involved solving for the
        intersection between the ray equation and the equation for a
        sphere.</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28">
      <span class="c9"
        >We first implemented a triangle intersection algorithm that solved for
        the time of intersection between the ray and the plane of the triangle,
        returning a valid intersection if the point at this time was also inside
        the points of the triangle. We encountered some issues with this
        technique and found that some model files were rendering with stray
        lines and artifacts, which we believed to be a bug with our
        implementation (an example of the bug is shown in our images
        below).</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28">
      <span class="c9"
        >Instead of spending more time identifying this bug, we switched to the
        Moller-Trumbore algorithm for ray-triangle intersection resulted in
        better performance and more correct behavior. In Moller-Trumbore, a
        vector equation is solved between the barycentric coordinates of the
        point of intersection and the ray equation for the distance from the ray
        origin to the intersection point.</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28">
      <span class="c9"
        >Below are some examples of scenes rendered with normal shading with the
        techniques described above:</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28 c20"><span class="c9"></span></p>
    <a id="t.c16af1f24f0b8befdce26f9d20ad9ce2880beedd"></a><a id="t.0"></a>
    <table class="c41">
      <tbody>
        <tr class="c3">
          <td class="c29" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 224.5px;
                  height: 168.38px;
                "
                ><img
                  alt=""
                  src="images/image20.png"
                  style="
                    width: 224.5px;
                    height: 168.38px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
            <p class="c1"><span class="c9">CBspheres_lambertian.dae</span></p>
          </td>
          <td class="c29" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 219px;
                  height: 164.09px;
                "
                ><img
                  alt=""
                  src="images/image2.png"
                  style="
                    width: 219px;
                    height: 164.09px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
            <p class="c1">
              <span class="c9"
                >CBCoil.dae, with the buggy intersection behavior</span
              >
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c29" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 231.09px;
                  height: 173.71px;
                "
                ><img
                  alt=""
                  src="images/image33.png"
                  style="
                    width: 231.09px;
                    height: 173.71px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
            <p class="c1">
              <span class="c9"
                >CBCoil.dae, using Moller-Trumbore intersection</span
              >
            </p>
          </td>
          <td class="c29" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 217.46px;
                  height: 163.46px;
                "
                ><img
                  alt=""
                  src="images/image9.png"
                  style="
                    width: 217.46px;
                    height: 163.46px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
            <p class="c1"><span class="c9">CBbunny.dae</span></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="c28 c20"><span class="c9"></span></p>
    <h2 class="c16" id="h.31jlh5ilb43d">
      <span>Part 2: Bounding Volume Hierarchy</span>
    </h2>
    <p class="c17">
      <span class="c0"
        >Our BVH construction algorithm first constructs a bounding box with all
        primitives passed in, then checks if the number of primitives is greater
        than the maximum leaf size. If the number of primitives is less than or
        equal to the maximum leaf size, we simply construct a node using the
        bounding box, set the start and end pointers according to the arguments,
        and return the node. Otherwise, if the number of primitives is greater,
        we partition the primitives and recurse, constructing BVH nodes for the
        left and right (using the partitioned sets of primitives), set the left
        and right pointers, then return the node.</span
      >
    </p>
    <p class="c17">
      <span class="c0"
        >Our heuristic for picking the splitting point to partition the
        primitives is how the primitive&rsquo;s centroid compares to the
        midpoint of the longest axis of the bounding box: e.g. if the longest
        axis is the x-axis, if the x coordinate of the centroid is less than the
        midpoint of the x-axis of the bounding box, the primitive would be
        grouped into the left node.</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28 c20"><span class="c9"></span></p>
    <a id="t.cb721f50a4e926f83e366c873fafd50d61fd04a9"></a><a id="t.1"></a>
    <table class="c41">
      <tbody>
        <tr class="c3">
          <td class="c29" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 239.13px;
                  height: 179.75px;
                "
                ><img
                  alt=""
                  src="images/image12.png"
                  style="
                    width: 239.13px;
                    height: 179.75px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
            <p class="c1"><span class="c9">CBdragon.dae</span></p>
          </td>
          <td class="c29" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 225.5px;
                  height: 168.61px;
                "
                ><img
                  alt=""
                  src="images/image25.png"
                  style="
                    width: 225.5px;
                    height: 168.61px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
            <p class="c1"><span class="c9">maxplanck.dae</span></p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c29" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 241.97px;
                  height: 181.89px;
                "
                ><img
                  alt=""
                  src="images/image21.png"
                  style="
                    width: 241.97px;
                    height: 181.89px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
            <p class="c1"><span class="c9">CBlucy.dae</span></p>
          </td>
          <td class="c29" colspan="1" rowspan="1">
            <p class="c1 c20"><span class="c9"></span></p>
            <p class="c1 c20"><span class="c9"></span></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="c17 c20"><span class="c6 c2"></span></p>
    <p class="c17">
      <span class="c0"
        >As shown in the table below, the rendering times were consistently at
        least 90% faster with BVH acceleration. We can also see that as the
        number of primitives increased, the render time without BVH increased
        (as it was going through every single primitive to check for
        intersections), but the speed improvement with BVH also increased, as
        the benefits of using BVH to efficiently check intersections with each
        primitive became more apparent.</span
      >
    </p>
    <a id="t.1c05e00e316a98416b1a55430316524e610ba24a"></a><a id="t.2"></a>
    <table class="c55">
      <tbody>
        <tr class="c3">
          <td class="c21" colspan="1" rowspan="1">
            <p class="c1"><span class="c38 c2">File</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c2 c38"># Primitives</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1">
              <span class="c38 c2">Render time without BVH</span>
            </p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c38 c2">Render time with BVH</span></p>
          </td>
          <td class="c27" colspan="1" rowspan="1">
            <p class="c1"><span class="c38 c2">Speed improvement</span></p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c21" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">meshedit/teapot.dae</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">2464</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">0.9758s</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">0.0618s</span></p>
          </td>
          <td class="c27" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">93.6%</span></p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c21" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">meshedit/cow.dae</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">5856</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">3.2630s</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">0.0876s</span></p>
          </td>
          <td class="c27" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">97.31%</span></p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c21" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">meshedit/beetle.dae</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">7558</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">2.5029s</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">0.0634s</span></p>
          </td>
          <td class="c27" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">97.4%</span></p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c21" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">sky/blob.dae</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">196608</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">53.2200s</span></p>
          </td>
          <td class="c12" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">0.1106s</span></p>
          </td>
          <td class="c27" colspan="1" rowspan="1">
            <p class="c1"><span class="c0">99.8%</span></p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 class="c16 c47" id="h.25utv5aa0f72"><span class="c31"></span></h2>
    <p class="c28 c20"><span class="c9"></span></p>
    <h2 class="c16" id="h.lg1afsg3yqck">
      <span>Part 3: Direct Illumination</span>
    </h2>
    <p class="c17">
      <span class="c2">For </span
      ><span class="c10 c2">estimate_direct_lighting_hemisphere</span
      ><span class="c2">, we sample uniformly in the hemisphere </span
      ><span class="c10 c2">num_samples</span
      ><span class="c0"
        >&nbsp;times. For each sample, we get the w_i from the hemisphere
        sampler and convert it to world-space coordinates. We create a test ray
        using the origin of hit_p with an offset of the world-space w_i
        multiplied by an epsilon constant and the direction as the world-space
        w_i. We then check the intersection of this ray &ndash; if there is an
        intersection, we get the emission for that intersection and compute the
        lighting at that intersection, divide it by the pdf, and add it to a
        running sum. Finally, we normalize the sum by the number of samples to
        get the estimated lighting.</span
      >
    </p>
    <p class="c17">
      <span class="c2">For </span
      ><span class="c10 c2">estimate_direct_lighting_importance</span
      ><span class="c0"
        >: we loop through every light source in the scene. For each light, if
        the light is a point light source, it only needs to be sampled once.
      </span>
    </p>
    <ul class="c34 lst-kix_93ip9l4swuse-0 start">
      <li class="c17 c48 li-bullet-0">
        <span class="c0"
          >To compute a single sample, we first get the light sample using
          sample_L. If the w_in&rsquo;s z coordinate is negative, we know that
          the light source is behind the hit point, so we don&rsquo;t need to
          cast the ray. Otherwise, we create a test ray from the hitpoint and
          test the ray&rsquo;s intersection. If the test ray doesn&rsquo;t
          intersect, we compute the lighting at this point, divided by the pdf,
          and add it to the running sum.
        </span>
      </li>
    </ul>
    <ul class="c34 lst-kix_kv4r27phas62-1 start">
      <li class="c17 c50 li-bullet-0">
        <span class="c0"
          >If the light is not a point light source, we repeat the sample
          process above ns_area_light times and divide the sample sum by the
          number of samples (ns_area_light).</span
        >
      </li>
      <li class="c17 c50 li-bullet-0">
        <span class="c0"
          >Finally, we normalize the sum by the number of light sources to get
          the estimated lighting.</span
        >
      </li>
    </ul>
    <p class="c17 c20"><span class="c6 c2"></span></p>
    <a id="t.92326fa6aeea0137b360544b50aa51e4a6c7dcc2"></a><a id="t.3"></a>
    <table class="c52">
      <tbody>
        <tr class="c3">
          <td class="c53" colspan="1" rowspan="1">
            <p class="c1 c20"><span class="c13 c2"></span></p>
          </td>
          <td class="c7" colspan="1" rowspan="1">
            <p class="c1">
              <span class="c13 c2">Uniform Hemisphere Sampling</span>
            </p>
          </td>
          <td class="c37" colspan="1" rowspan="1">
            <p class="c1"><span class="c13 c2">Importance Sampling</span></p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c53" colspan="1" rowspan="1">
            <p class="c1">
              <span class="c2 c42"
                >-t 8 -s 64 -l 32 -m 6 -f spheres_64_32.png -r 480 360
                ../dae/sky/CBspheres_lambertian.dae</span
              >
            </p>
          </td>
          <td class="c7" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 219.5px;
                  height: 164.35px;
                "
                ><img
                  alt=""
                  src="images/image10.png"
                  style="
                    width: 219.5px;
                    height: 164.35px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c37" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 222.71px;
                  height: 166.5px;
                "
                ><img
                  alt=""
                  src="images/image35.png"
                  style="
                    width: 222.71px;
                    height: 166.5px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c53" colspan="1" rowspan="1">
            <p class="c1">
              <span class="c2 c49"
                >-t 8 -s 64 -l 32 -m 6 -f bunny_64_32.png -r 480 360
                ../dae/sky/CBbunny.dae</span
              >
            </p>
          </td>
          <td class="c7" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 231px;
                  height: 173.33px;
                "
                ><img
                  alt=""
                  src="images/image13.png"
                  style="
                    width: 231px;
                    height: 173.33px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c37" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 223px;
                  height: 166.67px;
                "
                ><img
                  alt=""
                  src="images/image22.png"
                  style="
                    width: 223px;
                    height: 166.67px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="c17 c20"><span class="c13 c2"></span></p>
    <p class="c17">
      <span class="c0"
        >The following images use importance sampling with 1 sample per pixel
        with 1, 4, 16, and 64 samples per area light.</span
      >
    </p>
    <a id="t.ab3cc2b07d8fe425acf290db0930775d34e3ed68"></a><a id="t.4"></a>
    <table class="c41">
      <tbody>
        <tr class="c3">
          <td class="c23" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 142px;
                  height: 106.67px;
                "
                ><img
                  alt=""
                  src="images/image3.png"
                  style="
                    width: 142px;
                    height: 106.67px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c23" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 142px;
                  height: 106.67px;
                "
                ><img
                  alt=""
                  src="images/image11.png"
                  style="
                    width: 142px;
                    height: 106.67px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c23" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 142px;
                  height: 106.67px;
                "
                ><img
                  alt=""
                  src="images/image34.png"
                  style="
                    width: 142px;
                    height: 106.67px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c23" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 142px;
                  height: 106.67px;
                "
                ><img
                  alt=""
                  src="images/image6.png"
                  style="
                    width: 142px;
                    height: 106.67px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="c17 c20"><span class="c0"></span></p>
    <p class="c17">
      <span class="c0"
        >We can see that as we increase the number of samples per area light,
        the noise decreases and the soft shadows become more smooth and
        realistic. This is because as we take more samples, we have more values
        to average over, which allows us to get closer to the actual integral
        value using our Monte Carlo estimation.</span
      >
    </p>
    <p class="c17">
      <span class="c0"
        >This effect is especially apparent in the first image where we only
        take 1 sample per area light: since there is only one sample, the light
        is either occluded or not occluded, therefore the shadow appears choppy
        rather than smooth and uniform like the last image with 64 samples per
        area light.</span
      >
    </p>
    <p class="c5"><span class="c6 c2"></span></p>
    <p class="c17 c20"><span class="c6 c2"></span></p>
    <p class="c17">
      <span class="c0"
        >Uniform hemisphere sampling has a lot more noise compared to importance
        sampling because, in importance sampling, we iterate through each light
        source and only use directions that intersect the light sources, whereas
        with uniform hemisphere sampling, each ray has a pretty small chance of
        actually hitting the light source, so we&rsquo;re sampling many areas
        across the hemisphere which don&rsquo;t actually contribute to the
        lighting.</span
      >
    </p>
    <p class="c17 c20"><span class="c0"></span></p>
    <h2 class="c16" id="h.upoz9cicjhrh">
      <span>Part 4: Global Illumination</span>
    </h2>
    <p class="c17">
      <span class="c2"
        >We implemented indirect lighting functionality to our renderer through
        the </span
      ><span class="c10 c2">at_least_one_bounce_radiance</span
      ><span class="c0"
        >&nbsp;function, which calculates the radiance from direct lighting
        (rays connecting an object to a light source from 1 bounce) and indirect
        lighting (rays connecting an object to a light source from more than 1
        bounce).
      </span>
    </p>
    <p class="c17">
      <span class="c2">In </span
      ><span class="c10 c2">at_least_one_bounce_radiance</span
      ><span class="c2"
        >, we first sample the BSDF, which evaluates it at the point of
        intersection and samples a ray incident at that point. We use the BSDF
        value to add to the estimated radiance, and we use this sampled ray to
        find an intersection between this point and another object that could
        contribute to the lighting of this point through the sampled ray. We
        recurse on </span
      ><span class="c10 c2">at_least_one_bounce_radiance</span
      ><span class="c0"
        >&nbsp;with the sampled ray and this intersection.
      </span>
    </p>
    <p class="c17">
      <span class="c0"
        >This indirect lighting calculation occurs with a fixed termination
        probability of 0.35, meaning that we stop the recursion of the ray
        through light sources with a probability of 0.35, at each bounce after 1
        (Russian Roulette).</span
      >
    </p>
    <a id="t.4ddb8f843d82ffd23098bf8aea89b4b1c103b929"></a><a id="t.5"></a>
    <table class="c41">
      <tbody>
        <tr class="c3">
          <td class="c11" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 194px;
                  height: 145.33px;
                "
                ><img
                  alt=""
                  src="images/image5.png"
                  style="
                    width: 194px;
                    height: 145.33px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c11" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 194px;
                  height: 145.33px;
                "
                ><img
                  alt=""
                  src="images/image24.png"
                  style="
                    width: 194px;
                    height: 145.33px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c11" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 194px;
                  height: 145.33px;
                "
                ><img
                  alt=""
                  src="images/image27.png"
                  style="
                    width: 194px;
                    height: 145.33px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="c17 c20"><span class="c6 c2"></span></p>
    <a id="t.a43a35e9635170e85cf6fc97c2a47aed3015caa8"></a><a id="t.6"></a>
    <table class="c14">
      <tbody>
        <tr class="c3">
          <td class="c39" colspan="1" rowspan="1">
            <p class="c1">
              <span class="c13 c2">Only direct illumination</span>
            </p>
          </td>
          <td class="c15" colspan="1" rowspan="1">
            <p class="c1">
              <span class="c13 c2">Only indirect illumination</span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c39" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 274px;
                  height: 205.33px;
                "
                ><img
                  alt=""
                  src="images/image29.png"
                  style="
                    width: 274px;
                    height: 205.33px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c15" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 274px;
                  height: 205.33px;
                "
                ><img
                  alt=""
                  src="images/image15.png"
                  style="
                    width: 274px;
                    height: 205.33px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="c17 c20"><span class="c6 c2"></span></p>
    <h3 class="c40" id="h.s5qk14vpspy"><span>Comparing max ray depth</span></h3>
    <a id="t.81a60a176e6baad56577258a6cfae72b69a66a51"></a><a id="t.7"></a>
    <table class="c43">
      <tbody>
        <tr class="c3">
          <td class="c30" colspan="1" rowspan="1">
            <p class="c19"><span class="c13 c2">Max ray depth</span></p>
          </td>
          <td class="c4" colspan="1" rowspan="1">
            <p class="c1 c20"><span class="c13 c2"></span></p>
          </td>
        </tr>
        <tr class="c45">
          <td class="c30" colspan="1" rowspan="1">
            <p class="c19 c20"><span class="c13 c2"></span></p>
            <p class="c19"><span class="c13 c2">0</span></p>
          </td>
          <td class="c4" colspan="1" rowspan="1">
            <p class="c17">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 276.5px;
                  height: 207.03px;
                "
                ><img
                  alt=""
                  src="images/image31.png"
                  style="
                    width: 276.5px;
                    height: 207.03px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c30" colspan="1" rowspan="1">
            <p class="c19 c20"><span class="c13 c2"></span></p>
            <p class="c19"><span class="c13 c2">1</span></p>
          </td>
          <td class="c4" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 279.5px;
                  height: 209.28px;
                "
                ><img
                  alt=""
                  src="images/image8.png"
                  style="
                    width: 279.5px;
                    height: 209.28px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c30" colspan="1" rowspan="1">
            <p class="c19 c20"><span class="c13 c2"></span></p>
            <p class="c19"><span class="c13 c2">2</span></p>
          </td>
          <td class="c4" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 280.5px;
                  height: 210.03px;
                "
                ><img
                  alt=""
                  src="images/image23.png"
                  style="
                    width: 280.5px;
                    height: 210.03px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c30" colspan="1" rowspan="1">
            <p class="c19 c20"><span class="c13 c2"></span></p>
            <p class="c19"><span class="c13 c2">3</span></p>
          </td>
          <td class="c4" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 279.97px;
                  height: 209.64px;
                "
                ><img
                  alt=""
                  src="images/image26.png"
                  style="
                    width: 279.97px;
                    height: 209.64px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c30" colspan="1" rowspan="1">
            <p class="c19 c20"><span class="c13 c2"></span></p>
            <p class="c19"><span class="c13 c2">100</span></p>
          </td>
          <td class="c4" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 285.5px;
                  height: 213.77px;
                "
                ><img
                  alt=""
                  src="images/image32.png"
                  style="
                    width: 285.5px;
                    height: 213.77px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h3 class="c40" id="h.m88w6n7jbqs6">
      <span class="c26">Comparing sample-per-pixel rate</span>
    </h3>
    <p class="c1"><span class="c6 c2">CBspheres_lambertian.dae</span></p>
    <p class="c1 c20"><span class="c13 c2"></span></p>
    <a id="t.b5b196f514bf8e246de269103f84c0b69731c9cf"></a><a id="t.8"></a>
    <table class="c35">
      <tbody>
        <tr class="c3">
          <td class="c33" colspan="1" rowspan="1">
            <p class="c19"><span class="c13 c2">sample-per-pixel rate</span></p>
          </td>
          <td class="c22" colspan="1" rowspan="1">
            <p class="c1 c20"><span class="c13 c2"></span></p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c33" colspan="1" rowspan="1">
            <p class="c25"><span class="c13 c2">1</span></p>
          </td>
          <td class="c22" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 250px;
                  height: 188px;
                "
                ><img
                  alt=""
                  src="images/image16.png"
                  style="
                    width: 250px;
                    height: 188px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c33" colspan="1" rowspan="1">
            <p class="c25"><span class="c13 c2">2</span></p>
          </td>
          <td class="c22" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 250px;
                  height: 188px;
                "
                ><img
                  alt=""
                  src="images/image19.png"
                  style="
                    width: 250px;
                    height: 188px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c33" colspan="1" rowspan="1">
            <p class="c25"><span class="c13 c2">4</span></p>
          </td>
          <td class="c22" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 250px;
                  height: 188px;
                "
                ><img
                  alt=""
                  src="images/image28.png"
                  style="
                    width: 250px;
                    height: 188px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c33" colspan="1" rowspan="1">
            <p class="c25"><span class="c13 c2">8</span></p>
          </td>
          <td class="c22" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 250px;
                  height: 188px;
                "
                ><img
                  alt=""
                  src="images/image17.png"
                  style="
                    width: 250px;
                    height: 188px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c33" colspan="1" rowspan="1">
            <p class="c25"><span class="c13 c2">16</span></p>
          </td>
          <td class="c22" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 250px;
                  height: 188px;
                "
                ><img
                  alt=""
                  src="images/image30.png"
                  style="
                    width: 250px;
                    height: 188px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c33" colspan="1" rowspan="1">
            <p class="c25"><span class="c13 c2">64</span></p>
          </td>
          <td class="c22" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 250px;
                  height: 188px;
                "
                ><img
                  alt=""
                  src="images/image1.png"
                  style="
                    width: 250px;
                    height: 188px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
        <tr class="c3">
          <td class="c33" colspan="1" rowspan="1">
            <p class="c25"><span class="c13 c2">1024</span></p>
          </td>
          <td class="c22" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 251.74px;
                  height: 188.64px;
                "
                ><img
                  alt=""
                  src="images/image14.png"
                  style="
                    width: 251.74px;
                    height: 188.64px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="c17 c20"><span class="c6 c2"></span></p>
    <h2 class="c16" id="h.amjuk8yvog4e">
      <span class="c31">Part 5: Adaptive Sampling</span>
    </h2>
    <p class="c28">
      <span>In our implementation of adaptive sampling, we modify our </span
      ><span class="c10">raytrace_pixel</span
      ><span class="c9"
        >&nbsp;function to stop sampling early if we determine that the pixel
        has converged to a value.</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28">
      <span>To do this, we keep track of two additional values </span
      ><span class="c10">s1</span><span>&nbsp;and </span
      ><span class="c10">s2</span
      ><span
        >&nbsp;while we sample, which represents the sum of each sample&rsquo;s
        illuminance and the sum of each sample&rsquo;s illuminance squared,
        respectively. We use </span
      ><span class="c10">s1</span><span>&nbsp;and </span
      ><span class="c10">s2</span
      ><span class="c9"
        >&nbsp;to compute the mean and variance of the samples at each
        iteration.
      </span>
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28">
      <span>If we see that the convergence value </span><span class="c8">I</span
      ><span class="c9"
        >&nbsp;(defined below) is within our max tolerance value, then we stop
        generating ray samples for the pixel and use the current average value
        over the samples.</span
      >
    </p>
    <p class="c18">
      <span
        style="
          overflow: hidden;
          display: inline-block;
          margin: 0px 0px;
          border: 0px solid #000000;
          transform: rotate(0rad) translateZ(0px);
          -webkit-transform: rotate(0rad) translateZ(0px);
          width: 127.5px;
          height: 50.56px;
        "
        ><img
          alt=""
          src="images/image4.png"
          style="
            width: 127.5px;
            height: 50.56px;
            margin-left: 0px;
            margin-top: 0px;
            transform: rotate(0rad) translateZ(0px);
            -webkit-transform: rotate(0rad) translateZ(0px);
          "
          title=""
      /></span>
    </p>
    <p class="c18 c20"><span class="c9"></span></p>
    <a id="t.f727949b760321cc972232d42b2d9fa1f8785d82"></a><a id="t.9"></a>
    <table class="c46">
      <tbody>
        <tr class="c3">
          <td class="c32" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 298px;
                  height: 224px;
                "
                ><img
                  alt=""
                  src="images/image18.png"
                  style="
                    width: 298px;
                    height: 224px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
          <td class="c32" colspan="1" rowspan="1">
            <p class="c1">
              <span
                style="
                  overflow: hidden;
                  display: inline-block;
                  margin: 0px 0px;
                  border: 0px solid #000000;
                  transform: rotate(0rad) translateZ(0px);
                  -webkit-transform: rotate(0rad) translateZ(0px);
                  width: 298px;
                  height: 224px;
                "
                ><img
                  alt=""
                  src="images/image7.png"
                  style="
                    width: 298px;
                    height: 224px;
                    margin-left: 0px;
                    margin-top: 0px;
                    transform: rotate(0rad) translateZ(0px);
                    -webkit-transform: rotate(0rad) translateZ(0px);
                  "
                  title=""
              /></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="c18 c20"><span class="c9"></span></p>
    <p class="c28">
      <span class="c44">Note:</span
      ><span class="c24"
        >&nbsp;We found that the above images, compared to the reference, might
        suggest that portions of the scene are still being oversampled by the
        raytracer. We still noticed an image quality and performance benefit
        from this adaptive sampling technique.</span
      >
    </p>
    <h2 class="c16" id="h.7zr5cb87yk1s">
      <span class="c31">Collaboration Addendum</span>
    </h2>
    <p class="c28">
      <span class="c9"
        >Annie and Ethan worked together to complete this project. Ethan worked
        on the ray generation and scene intersection implementation of Part 1
        and helped to debug illumination issues in Part 3. Annie completed the
        BVH acceleration of Part 2 and implemented all lighting tasks in Parts
        3-5. We tried to balance our collective understanding of the
        project&rsquo;s contents by completing the write-up portion for tasks
        that the other collaborator implemented.</span
      >
    </p>
    <p class="c28 c20"><span class="c9"></span></p>
    <p class="c28">
      <span
        >While we had trouble during the beginning of the project timeline
        finding common times to meet, we were able to work asynchronously for
        the most part and meeting occasionally for status updates and
        goalsetting. We learned about the implementation complexities of
        raytracing (such as dealing with floating-point precision) and a more
        intuitive and geometric sense of light bouncing in a scene towards the
        camera. From a collaboration perspective, we learned that we should meet
        more often in the project timeline to make sure we are on-track to meet
        our intended deadlines.</span
      >
    </p>
  </body>
</html>
